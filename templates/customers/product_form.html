{% extends "customers/base.html" %}
{% load static %}

{% block title %}Add/Edit Product - Subhlabh{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/product_form.css' %}">
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <h1>üì¶ Add Product/Service</h1>
        <p>Add new products or services to your inventory</p>
    </div>
    <div class="header-actions">
        <a href="{% url 'customers:product-list' %}" class="btn-secondary">‚Üê Back to Products</a>
    </div>
</div>

<div class="form-container">
    <form method="POST" enctype="multipart/form-data" class="product-form">
        {% csrf_token %}

        <div class="form-section">
            <h3>Basic Information</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="product_type" class="form-label">Type *</label>
                    <select id="product_type" name="product_type" class="form-input" required
                        onchange="toggleProductFields()">
                        {% for value, label in product_types %}
                        <option value="{{ value }}" {% if product and product.product_type == value %}selected{% endif %}>
                            {{ label }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="name" class="form-label">Name *</label>
                    <input type="text" id="name" name="name" class="form-input" value="{{ product.name|default:'' }}"
                        placeholder="Enter name" required>
                </div>

                <div class="form-group">
                    <label for="category" class="form-label">Category *</label>
                    <select id="category" name="category" class="form-input" required>
                        <option value="">Select category</option>
                        {% for value, label in categories %}
                        <option value="{{ value }}" {% if product and product.category == value %}selected{% endif %}>{{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="price" class="form-label">Price (‚Çπ) *</label>
                    <input type="number" id="price" name="price" class="form-input" step="0.01" min="0"
                        value="{{ product.price|default:'0' }}" placeholder="0.00" required>
                </div>
            </div>
        </div>

        <div class="form-section" id="productFields">
            <h3>Product Details</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label for="unit" class="form-label">Unit *</label>
                    <select id="unit" name="unit" class="form-input">
                        <option value="">Select unit</option>
                        {% for value, label in units %}
                        <option value="{{ value }}" {% if product and product.unit == value %}selected{% endif %}>{{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="stock_quantity" class="form-label">Stock Quantity *</label>
                    <input type="number" id="stock_quantity" name="stock_quantity" class="form-input" step="0.01"
                        min="0" value="{{ product.stock_quantity|default:'0' }}" placeholder="0" required>
                </div>
            </div>
        </div>

        <div class="form-section" id="serviceFields" style="display: none;">
            <h3>Service Details</h3>
            <div class="form-group full-width">
                <label for="description" class="form-label">Description</label>
                <textarea id="description" name="description" class="form-textarea" rows="4"
                    placeholder="Describe the service...">{{ product.description|default:'' }}</textarea>
            </div>
        </div>

        <div class="form-section">
            <h3>Image (Optional)</h3>
            <div class="form-group full-width">
                <input type="file" id="image" name="image" class="form-input" accept="image/*">
                {% if product and product.image %}
                <div class="current-image">
                    <p>Current image:</p>
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" style="max-width: 200px;">
                </div>
                {% endif %}
            </div>
        </div>

        <div class="form-actions">
            <a href="{% url 'customers:product-list' %}" class="btn-cancel">Cancel</a>
            <button type="submit" class="btn-submit">
                {% if product %}üíæ Update{% else %}‚ûï Add{% endif %} Product/Service
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/product_form.js' %}"></script>
{% endblock %}