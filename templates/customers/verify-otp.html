{% extends 'base.html' %}
{% load static %}

{% block title %}Verify OTP - SubhLabh{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/auth-modern.css' %}">
{% endblock %}

{% block content %}
<div class="auth-modern-container">
    <!-- Left Hero Section -->
    <div class="auth-left-section">
        <div class="auth-hero-content">
            <div class="auth-brand-logo">
                <img src="{% static 'images/Logo.png' %}" alt="SubhLabh Logo">
            </div>
            <h1 class="auth-hero-title">Verify Your Email</h1>
            <p class="auth-hero-subtitle">We've sent a 6-digit code to your email. Enter it below to verify your account
                and continue.</p>
        </div>
    </div>

    <!-- Right Form Section -->
    <div class="auth-right-section">
        <div class="auth-form-card">
            <!-- Form Header -->
            <div class="auth-form-header">
                <div class="logo-mini">
                    <img src="{% static 'images/Logo.png' %}" alt="SubhLabh">
                </div>
                <h2 class="auth-form-title">Enter OTP</h2>
                <p class="auth-form-subtitle">We've sent a 6-digit code to<br><strong>{{ email }}</strong></p>
            </div>

            <!-- Messages -->
            {% if messages %}
            <div class="messages-container">
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }} fade-in">
                    <span class="alert-icon">{{ message.tags|upper|first }}</span>
                    <span class="alert-text">{{ message }}</span>
                    <button type="button" class="alert-close"
                        onclick="this.parentElement.style.display='none';">&times;</button>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- OTP Form -->
            <form method="POST" class="auth-form" id="otpForm">
                {% csrf_token %}

                <div class="form-group">
                    <label for="otp" class="form-label">6-Digit Code</label>
                    <input type="text" id="otp" name="otp" class="form-control otp-input" placeholder="Enter OTP"
                        maxlength="6" required value="{{ otp_value|default:'' }}">
                </div>

                <button type="submit" class="btn btn-primary">
                    <span class="btn-text">Verify OTP</span>
                    <span class="btn-loader">
                        <span class="spinner"></span> Verifying...
                    </span>
                </button>

                <div class="timer-section">
                    <p class="timer-text">Didn't receive the code?</p>
                    <button type="button" class="btn-resend" id="resendBtn" onclick="resendOTP()">
                        Resend OTP <span id="timer" class="timer-countdown"></span>
                    </button>
                </div>
            </form>

            <!-- Footer -->
            <div class="form-footer">
                <p class="footer-text">Need help? <a href="#" class="link-hover">Contact support</a></p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    window.otpConfig = {
        email: '{{ email }}',
        purpose: '{{ purpose|default:"signup" }}',
        resendUrl: '{% url "customers:resend-otp" %}'
    };
</script>
<script src="{% static 'js/auth.js' %}"></script>
<script src="{% static 'js/verify_otp.js' %}"></script>
{% endblock %}